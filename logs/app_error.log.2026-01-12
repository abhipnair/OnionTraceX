2026-01-12 11:40:24 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/privacy: Connection refused by destination host
2026-01-12 11:40:29 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/ru: Connection refused by destination host
2026-01-12 11:40:32 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/pgp-keys: Connection refused by destination host
2026-01-12 11:40:34 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en: Connection refused by destination host
2026-01-12 11:40:37 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/faq: Connection refused by destination host
2026-01-12 11:40:42 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/terms: Connection refused by destination host
2026-01-12 11:40:45 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/contacts: Connection refused by destination host
2026-01-12 11:40:50 - app - ERROR - [logger.py:103] - Unexpected error for http://mixermo4pgkgep3k3qr4fz7dhijavxnh6lwgu7gf5qeltpy4unjed2yd.onion/en/how-it-works: Connection refused by destination host
2026-01-12 13:19:52 - app - ERROR - [logger.py:103] - /api/site/2f4a58c750b4f69ae9583bccd2faf3fc12daa5d7205d21d30588b396a33622f6 error: column "tx_analysed" does not exist
HINT:  Perhaps you meant to reference the column "bitcoinaddresses.tx_analyzed".
2026-01-12 13:19:53 - app - ERROR - [logger.py:103] - /api/site/2f4a58c750b4f69ae9583bccd2faf3fc12daa5d7205d21d30588b396a33622f6 error: column "tx_analysed" does not exist
HINT:  Perhaps you meant to reference the column "bitcoinaddresses.tx_analyzed".
2026-01-12 13:26:54 - app - ERROR - [logger.py:103] - /api/site/d8c11f762aebced8fe64c3e259883ffc9b7be6136baebcdd2b3aec726454362e error: column "tx_analysed" does not exist
HINT:  Perhaps you meant to reference the column "bitcoinaddresses.tx_analyzed".
2026-01-12 19:28:39 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:28:51 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:00 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:05 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:05 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:06 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:06 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:06 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:07 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:29:39 - app - ERROR - [api.py:717] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 147, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: expected a datetime.date or datetime.datetime instance, got 'str'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 686, in sites
    rows, total = future.result()
                  ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 638, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: '2026-01-12T06:35:09.935269+00:00' (expected a datetime.date or datetime.datetime instance, got 'str')
2026-01-12 19:33:27 - app - ERROR - [api.py:711] - /api/sites failed
Traceback (most recent call last):
  File "asyncpg/protocol/prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg/protocol/codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg/protocol/codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg/pgproto/./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 692, in sites
    rows, next_cursor = future.result()
                        ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/abhipnair/Projects/major_project/oniontrace_x/API/api.py", line 649, in fetch_sites
    rows = await conn.fetch(
           ^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 690, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1864, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 1961, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/abhipnair/Projects/major_project/oniontrace_x/project_venv/lib/python3.13/site-packages/asyncpg/connection.py", line 2024, in _do_execute
    result = await executor(stmt, None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 185, in bind_execute
  File "asyncpg/protocol/prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $7: datetime.datetime(2026, 1, 12, 6, 35, 9,... (can't subtract offset-naive and offset-aware datetimes)
